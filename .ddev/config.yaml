name: mage2gen
type: generic
project_tld: ddev.site

# 1. Configure Database
database:
  type: postgres
  version: "13"

# 2. Configure Web Container Params
# These are injected into the container and read by settings/local.py
web_environment:
  - DJANGO_SETTINGS_MODULE=settings
  - DJANGO_SECRET_KEY=changeme-for-production
  - MAGE2GEN_DB_NAME=db
  - MAGE2GEN_DB_USER=db
  - MAGE2GEN_DB_PASS=db
  - MAGE2GEN_DB_HOST=db
  - MAGE2GEN_DB_PORT=5432
  - MODULE_GENERATION_PATH=/usr/app/src/generated_modules
  # Tells DDEV router which internal port to serve
  - HTTP_EXPOSE=8000

# 3. Hooks (Automation)
hooks:
  pre-start:
    - exec-host: chmod +x .ddev/commands/host/init-core && .ddev/commands/host/init-core